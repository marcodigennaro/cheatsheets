
#

units           real
atom_style      full
boundary        p p p
bond_style      harmonic
angle_style     harmonic

kspace_style pppm/cg 1.0e-4
kspace_modify pressure/scalar yes

neighbor 2.0 bin
neigh_modify delay 0 every 1 check yes

pair_style nm/cut/coul/long 20.0 30.0

read_data       emim_bf4_CG.in

group 	anion  	type 	1
group 	ring   	type 	2
group 	methyl 	type 	3
group 	ethyl  	type 	4

velocity       	all zero linear
variable 	ILpe equal pe
fix 		1 all print 1 "${radius} ${ILpe}" lmps_pot_ener.dat

compute 	1 all bond/local dist engpot force omega 
compute 	2 all angle/local eng theta
dump		1 all local 100 bonds.dump c_1[*]
dump		2 all local 100 angle.dump c_2[*]

# MD settings
fix frzanion anion   setforce 0.0 0.0 0.0
fix frzring  ring    setforce 0.0 0.0 0.0
fix frzeth   methyl  setforce 0.0 0.0 0.0
fix frzmeth  ethyl   setforce NULL NULL 0.0

reset_timestep  0
timestep        0.5

label radius_loop
variable	radius index   2.0 5.0 10.0 
variable	theta  equal   90
variable 	phi    equal    0

variable  	vxx equal sin($(v_theta/180*PI))*cos($(v_phi/180*PI))
variable  	vzz equal sin($(v_theta/180*PI))*sin($(v_phi/180*PI))
variable  	vyy equal cos($(v_theta/180*PI))
variable  	xx equal v_radius*v_vxx
variable  	yy equal v_radius*v_vyy
variable  	zz equal v_radius*v_vzz

set 		atom 1 x ${xx} y ${yy} z ${zz}
minimize 	0.0 1.0e-8 1000 100000

run      	1

next radius
jump lmps.inp radius_loop

next phi
jump lmps.inp phi_loop

next theta
jump lmps.inp theta_loop
